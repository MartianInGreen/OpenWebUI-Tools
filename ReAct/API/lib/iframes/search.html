<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Results</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .search-results {
            max-width: 800px;
            margin: 0 auto;
        }
        .result-item {
            background: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            gap: 16px;
        }
        .result-image {
            width: 120px;
            height: 80px;
            object-fit: cover;
            border-radius: 4px;
        }
        .result-content {
            flex: 1;
        }
        .result-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .result-favicon {
            width: 16px;
            height: 16px;
        }
        .result-title {
            color: #1a0dab;
            font-size: 18px;
            margin: 0;
            text-decoration: none;
        }
        .result-title:hover {
            text-decoration: underline;
        }
        .result-meta {
            color: #006621;
            font-size: 14px;
            margin: 0 0 8px 0;
        }
        .result-snippet {
            color: #545454;
            font-size: 14px;
            line-height: 1.4;
        }
        .no-results {
            text-align: center;
            color: #666;
            padding: 40px;
        }
    </style>
</head>
<body>
    <div class="search-results" id="searchResults">
        <!-- Results will be populated here -->
    </div>

    <script>
        function displayResults(data) {
            const resultsContainer = document.getElementById('searchResults');
            
            if (!data || !data.data || !data.data.results || data.data.results.length === 0) {
                resultsContainer.innerHTML = '<div class="no-results">No results found</div>';
                return;
            }

            let resultsHTML = '';
            
            // Handle Exa search results
            if (data.data.results) {
                data.data.results.forEach(result => {
                    resultsHTML += createResultItem(result);
                });
            } else if (typeof data.data === 'string') {
                // Handle Perplexity results
                resultsHTML = `<div class="result-item">
                    <div class="result-snippet">${data.data}</div>
                </div>`;
            }

            resultsContainer.innerHTML = resultsHTML;
        }

        function createResultItem(result) {
            const title = result.title || 'Untitled';
            const url = result.url || '#';
            const snippet = result.text || '';
            const image = result.image || '';
            const favicon = result.favicon || '';
            const author = result.author || '';
            const date = result.publishedDate ? new Date(result.publishedDate).toLocaleDateString() : '';

            return `
                <div class="result-item">
                    ${image ? `<img src="${image}" alt="${title}" class="result-image">` : ''}
                    <div class="result-content">
                        <div class="result-header">
                            ${favicon ? `<img src="${favicon}" alt="" class="result-favicon">` : ''}
                            <a href="${url}" class="result-title" target="_blank">${title}</a>
                        </div>
                        <div class="result-meta">
                            ${url}
                            ${author ? ` • ${author}` : ''}
                            ${date ? ` • ${date}` : ''}
                        </div>
                        <div class="result-snippet">${snippet}</div>
                    </div>
                </div>
            `;
        }

        // Listen for messages from the parent window for dynamic updates
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'searchResults') {
                displayResults(event.data.results);
            }
        });
    </script>
</body>
</html>
